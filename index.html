<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>nazo</title><meta name="next-head-count" content="3"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-167539311-1"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-167539311-1', {
              page_path: window.location.pathname,
            });
          </script><link rel="preload" href="/_next/static/css/3c44c040a8c93448.css" as="style"/><link rel="stylesheet" href="/_next/static/css/3c44c040a8c93448.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-fd82975a6094609f.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-01df828e572375b9.js" defer=""></script><script src="/_next/static/chunks/pages/_app-751a1fd121b4aa07.js" defer=""></script><script src="/_next/static/chunks/641-20312f55b686761c.js" defer=""></script><script src="/_next/static/chunks/pages/index-d5c75092cdf933bf.js" defer=""></script><script src="/_next/static/R8mBktx4UQO9HsIBGaZuR/_buildManifest.js" defer=""></script><script src="/_next/static/R8mBktx4UQO9HsIBGaZuR/_ssgManifest.js" defer=""></script><script src="/_next/static/R8mBktx4UQO9HsIBGaZuR/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div><nav class="bg-gray-800"><div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"><div class="flex items-center justify-between h-16"><div class="flex items-center"><div class="flex-shrink-0"><img class="h-8 w-8" src="/images/nazo.png" alt="nazo"/></div><div class="hidden md:block"><div class="ml-10 flex items-baseline"><a class="px-3 py-2 rounded-md text-sm font-medium text-white bg-gray-900 focus:outline-none focus:text-white focus:bg-gray-700" href="/">概要</a><a class="ml-4 px-3 py-2 rounded-md text-sm font-medium text-gray-300 hover:text-white hover:bg-gray-700 focus:outline-none focus:text-white focus:bg-gray-700" href="/profile">プロフィール</a></div></div></div></div></div></nav><main><div class="bg-gray-100 pt-10"><div class="mx-auto max-w-6xl"><div class="p-2 bg-gray-100 rounded"><div class="flex flex-col md:flex-row"><div class="md:w-1/3 p-4 text-sm"><div class="text-3xl"><span class="font-medium">nazo</span></div><div class="my-2">フリーランスWebエンジニア</div></div><div class="md:w-2/3"><div class="p-4"><div class="mb-2"><div class="font-medium rounded-sm text-lg px-2 py-3 flex text-gray-800 flex-row-reverse mt-2 text-black bg-white hover:bg-white"><div class="flex-auto">もう少ししっかりしたアウトプットある？</div></div><div class="p-2 text-justify text-left text-gray-800 mb-5 bg-white"><a href="https://github.com/nazo/" class="underline font-medium text-lg">GitHub</a>にていくつかソースコードを公開しております。まとまった内容は<a href="https://nazo.hatenablog.com/" class="underline font-medium text-lg">ブログ</a>にて発信しております。あまりまとまっていない内容は<a href="https://gist.github.com/nazo/" class="underline font-medium text-lg">Gist</a>にもあります。</div></div><div class="mb-2"><div class="font-medium rounded-sm text-lg px-2 py-3 flex text-gray-800 flex-row-reverse mt-2 text-black bg-white hover:bg-white"><div class="flex-auto">仕事頼みたいんだけどどうしたらいいかな？</div></div><div class="p-2 text-justify text-left text-gray-800 mb-5 bg-white"><a class="underline font-medium text-lg" href="/profile">Webエンジニアとしてのプロフィール</a>をまとめてありますので、こちらを一読の上ご連絡をお待ちしております。</div></div></div></div></div></div></div></div><div class="bg-gray-100 pt-10"><div class="mx-auto max-w-6xl"><h2 class="pb-5 text-xl font-bold">最近のアップデート</h2><div class="flex flex-col"><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/2021-works" class="underline">2021年の仕事まとめ</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/entgo-ulid" class="underline">ent ( entgo.io/ent ) で ULID を使う</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/iac-first" class="underline"> Infrastructure as Codeは最初からやったほうがいい</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/project-onboarding" class="underline">Webエンジニアが新規でプロジェクトに入った時に確認すること</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/2021/01/19/115358" class="underline">M1(Apple Silicon) Mac に google-cloud-sdk を無理やりインストールする（2021/01/19時点）</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/2020-works" class="underline">2020年の仕事と技術の振り返り</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/rust-nes-wasm" class="underline">rust-nesをwasm化した</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Blog</span><a href="https://nazo.hatenablog.com/entry/nuxt-http-credentials" class="underline">nuxt/http で axios-module の credentials: true を再現する</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Gist</span><a href="https://gist.github.com/nazo/400638c53982b485b4865e3b2361ab45" class="underline">Nuxt.jsの型定義ファイル</a></div><div class="text-black text-left bg-gray-400 px-4 py-2 m-2"><span class="mx-5">Gist</span><a href="https://gist.github.com/nazo/d2f765da5942b8d71797b188f20c4bb0" class="underline">WSL2 小ネタ</a></div></div></div></div></main><div class="mt-20">このページのソースコードは <a href="https://github.com/nazo/nazo.dev" class="underline font-medium text-lg">https://github.com/nazo/nazo.dev</a> で公開されています。</div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"items":[{"title":"2021年の仕事まとめ","link":"https://nazo.hatenablog.com/entry/2021-works","pubDate":"2021-12-28T03:00:00.000Z","author":"nazone","content":"\u003cul\u003e\n\u003cli\u003e2020年 : \u003ca href=\"https://nazo.hatenablog.com/entry/2020-works\"\u003ehttps://nazo.hatenablog.com/entry/2020-works\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e2019年 : \u003ca href=\"https://nazo.hatenablog.com/entry/goodbye-uuum\"\u003ehttps://nazo.hatenablog.com/entry/goodbye-uuum\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003ch1\u003eGo による \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\"\u003eAPI\u003c/a\u003e サーバーと React による管理画面開発\u003c/h1\u003e\n\n\u003cp\u003eGo で gRPC サーバーを作りつつ、 React と gqlgen で 管理画面を作るというような内容でした。\u003c/p\u003e\n\n\u003cp\u003e都合により短期でしか関われなかったのですが、あまりお目にかかれない環境での開発で非常に楽しい経験をさせて頂きました。\u003c/p\u003e\n\n\u003ch1\u003e株式会社ハグカム　様\u003c/h1\u003e\n\n\u003cp\u003e\u003ca href=\"https://www.global-crown.com/\"\u003eGLOBAL CROWN\u003c/a\u003e という子ども向け英会話サービスを提供しております。\u003ca href=\"https://prtimes.jp/main/html/rd/p/000000004.000019731.html\"\u003e今年初めに資金調達も行っており\u003c/a\u003e 、絶賛成長中のサービスになっております。\u003c/p\u003e\n\n\u003cp\u003e私も少しだけお世話になっており、主にコア\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003eからは少し距離を置いたものを中心に、以下のような内容を行っておりました。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003eGCE で動いていたインフラを Cloud Run に移行\u003c/li\u003e\n\u003cli\u003eインフラの Terraform 化\u003c/li\u003e\n\u003cli\u003elinter を整備してコード品質を上げる\u003c/li\u003e\n\u003cli\u003eCI / CD の整備\u003c/li\u003e\n\u003cli\u003e負荷チューニング\u003c/li\u003e\n\u003cli\u003eDocker 開発環境の整備\u003c/li\u003e\n\u003cli\u003e言語や\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EC%A1%BC%A5%E0%A5%EF%A1%BC%A5%AF\"\u003eフレームワーク\u003c/a\u003eのアップグレード\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eサーバーサイドの言語としては \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/PHP\"\u003ePHP\u003c/a\u003e と \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Ruby\"\u003eRuby\u003c/a\u003e を利用しており、久々に長期で \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/PHP\"\u003ePHP\u003c/a\u003e を触っていました。\u003c/p\u003e\n\n\u003cp\u003eまた、\u003ca href=\"https://www.hugcome.co.jp/\"\u003eコーポレートサイト\u003c/a\u003e を Next.js + Netlify で SSG 化したり、未公開の内容についての対応なども行っておりました。\u003c/p\u003e\n\n\u003cp\u003e今年は仕事以外のところでいろいろあったのですが、ハグカム様にはかなり融通を利かせて頂いて助かりました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\"\u003eRails\u003c/a\u003e エンジニアや Flutter エンジニアなどを積極的に採用中ですので、興味があれば以下から応募するか私までご連絡下さい。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.hugcome.co.jp%2Fengineer\" title=\"ソフトウェアエンジニア | 株式会社ハグカム\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://www.hugcome.co.jp/engineer\"\u003ewww.hugcome.co.jp\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fwww.green-japan.com%2Fcompany%2F8109\" title=\"株式会社 ハグカム | IT/Web業界への転職ならGreen(グリーン)\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://www.green-japan.com/company/8109\"\u003ewww.green-japan.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003ch1\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003e今年はプライベートで良くないことが続く年でしたが、来年後半からはまた良い状況が生まれてくるはずなので、そこから活動を増やしていきたいと考えています。\u003c/p\u003e\n\n\u003cp\u003e引き続きお仕事を募集しております。詳細は \u003ca href=\"https://nazo.dev/profile\"\u003ehttps://nazo.dev/profile\u003c/a\u003e をご覧下さい。\u003c/p\u003e\n","contentSnippet":"2020年 : https://nazo.hatenablog.com/entry/2020-works\n2019年 : https://nazo.hatenablog.com/entry/goodbye-uuum\nGo による API サーバーと React による管理画面開発\nGo で gRPC サーバーを作りつつ、 React と gqlgen で 管理画面を作るというような内容でした。\n都合により短期でしか関われなかったのですが、あまりお目にかかれない環境での開発で非常に楽しい経験をさせて頂きました。\n株式会社ハグカム　様\nGLOBAL CROWN という子ども向け英会話サービスを提供しております。今年初めに資金調達も行っており 、絶賛成長中のサービスになっております。\n私も少しだけお世話になっており、主にコアドメインからは少し距離を置いたものを中心に、以下のような内容を行っておりました。\nGCE で動いていたインフラを Cloud Run に移行\nインフラの Terraform 化\nlinter を整備してコード品質を上げる\nCI / CD の整備\n負荷チューニング\nDocker 開発環境の整備\n言語やフレームワークのアップグレード\nサーバーサイドの言語としては PHP と Ruby を利用しており、久々に長期で PHP を触っていました。\nまた、コーポレートサイト を Next.js + Netlify で SSG 化したり、未公開の内容についての対応なども行っておりました。\n今年は仕事以外のところでいろいろあったのですが、ハグカム様にはかなり融通を利かせて頂いて助かりました。\nRails エンジニアや Flutter エンジニアなどを積極的に採用中ですので、興味があれば以下から応募するか私までご連絡下さい。\nwww.hugcome.co.jp\nwww.green-japan.com\nまとめ\n今年はプライベートで良くないことが続く年でしたが、来年後半からはまた良い状況が生まれてくるはずなので、そこから活動を増やしていきたいと考えています。\n引き続きお仕事を募集しております。詳細は https://nazo.dev/profile をご覧下さい。","id":"hatenablog://entry/26006613716445536","isoDate":"2021-12-28T03:00:00.000Z"},{"title":"ent ( entgo.io/ent ) で ULID を使う","link":"https://nazo.hatenablog.com/entry/entgo-ulid","pubDate":"2021-03-09T03:00:00.000Z","author":"nazone","content":"\u003cp\u003eent では UUID 型がデフォルトでサポートされているのですが、それとは別に \u003ca href=\"https://github.com/ulid/spec\"\u003eULID\u003c/a\u003e を使う方法を解説します。\u003c/p\u003e\n\n\u003cp\u003eULID の実装は \u003ca href=\"https://github.com/oklog/ulid\"\u003ehttps://github.com/oklog/ulid\u003c/a\u003e を使用します。\u003c/p\u003e\n\n\u003cp\u003eent の UUID 型は、\u003ca href=\"https://golang.org/pkg/database/sql/driver/#Valuer\"\u003edriver.Valuer\u003c/a\u003e Interface を利用して値を取得しますが、 oklog/ulid の \u003ccode\u003eValue()\u003c/code\u003e の実装がバイナリを返却するようになっているため、このままでは可読性が悪いです。 \u003ccode\u003eValue()\u003c/code\u003e が String を返すようにした ULID 型を新たに定義するのが良いでしょう。そのようにすると、他の interface も実装する必要があります。\u003c/p\u003e\n\n\u003cp\u003e結論から言うと \u003ca href=\"https://github.com/ent/contrib/blob/6623819401500db45747a2419172963217cef619/entgql/internal/todopulid/ent/schema/pulid/pulid.go\"\u003ehttps://github.com/ent/contrib/blob/6623819401500db45747a2419172963217cef619/entgql/internal/todopulid/ent/schema/pulid/pulid.go\u003c/a\u003e にそのものの実装があります\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003e。この実装はライブラリ化されているものではない（ internal ）ので、そのままコピペして利用するのが良いでしょう。\u003c/p\u003e\n\n\u003cp\u003e使用する場合には以下のようになります。\u003c/p\u003e\n\n\u003cpre class=\"code lang-go\" data-lang=\"go\" data-unlink\u003e\u003cspan class=\"synComment\"\u003e// Fields of the User.\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003efunc\u003c/span\u003e (User) Fields() []ent.Field {\n    \u003cspan class=\"synStatement\"\u003ereturn\u003c/span\u003e []ent.Field{\n        field.String(\u003cspan class=\"synConstant\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e).\n            GoType(pulid.ID(\u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e)).\n            DefaultFunc(\u003cspan class=\"synType\"\u003efunc\u003c/span\u003e() pulid.ID { \u003cspan class=\"synStatement\"\u003ereturn\u003c/span\u003e pulid.MustNew(\u003cspan class=\"synConstant\"\u003e\u0026quot;US\u0026quot;\u003c/span\u003e) }),\n        field.Int(\u003cspan class=\"synConstant\"\u003e\u0026quot;age\u0026quot;\u003c/span\u003e).Positive(),\n        field.String(\u003cspan class=\"synConstant\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e).Default(\u003cspan class=\"synConstant\"\u003e\u0026quot;unknown\u0026quot;\u003c/span\u003e),\n    }\n}\n\u003c/pre\u003e\n\n\n\u003cp\u003eprefixが不要な場合はprefixの部分を削ってしまうのが良いかと思います。\u003c/p\u003e\n\n\u003cp\u003eこのままの実装でもう少し手軽に書きたい場合は、同\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%EA%A5%DD%A5%B8%A5%C8%A5%EA\"\u003eリポジトリ\u003c/a\u003eに \u003ca href=\"https://github.com/ent/contrib/blob/6623819401500db45747a2419172963217cef619/entgql/internal/todopulid/ent/schema/pulid/mixin.go\"\u003emixin\u003c/a\u003e が存在しますので、これを持ち出すと良いと思います。\u003c/p\u003e\n\n\u003cp\u003eent は各フィールドを固有の型にできますので、例えば上記例で ID を \u003ccode\u003eUserID\u003c/code\u003e 型にしたい場合は以下のようになります。\u003c/p\u003e\n\n\u003cpre class=\"code lang-go\" data-lang=\"go\" data-unlink\u003e\u003cspan class=\"synStatement\"\u003etype\u003c/span\u003e UserID pulid.ID\n\n\u003cspan class=\"synComment\"\u003e// Fields of the User.\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003efunc\u003c/span\u003e (User) Fields() []ent.Field {\n    \u003cspan class=\"synStatement\"\u003ereturn\u003c/span\u003e []ent.Field{\n        field.String(\u003cspan class=\"synConstant\"\u003e\u0026quot;id\u0026quot;\u003c/span\u003e).\n            GoType(UserID(\u003cspan class=\"synConstant\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e)).\n            DefaultFunc(\u003cspan class=\"synType\"\u003efunc\u003c/span\u003e() UserID { \u003cspan class=\"synStatement\"\u003ereturn\u003c/span\u003e UserID(pulid.MustNew(\u003cspan class=\"synConstant\"\u003e\u0026quot;US\u0026quot;\u003c/span\u003e)) }),\n        field.Int(\u003cspan class=\"synConstant\"\u003e\u0026quot;age\u0026quot;\u003c/span\u003e).Positive(),\n        field.String(\u003cspan class=\"synConstant\"\u003e\u0026quot;name\u0026quot;\u003c/span\u003e).Default(\u003cspan class=\"synConstant\"\u003e\u0026quot;unknown\u0026quot;\u003c/span\u003e),\n    }\n}\n\u003c/pre\u003e\n\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/tmc/pulid\"\u003ehttps://github.com/tmc/pulid\u003c/a\u003e のように見えるのですが、こちらは \u003ccode\u003eValue()\u003c/code\u003e はバイナリを返すようです。\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"ent では UUID 型がデフォルトでサポートされているのですが、それとは別に ULID を使う方法を解説します。\nULID の実装は https://github.com/oklog/ulid を使用します。\nent の UUID 型は、driver.Valuer Interface を利用して値を取得しますが、 oklog/ulid の Value() の実装がバイナリを返却するようになっているため、このままでは可読性が悪いです。 Value() が String を返すようにした ULID 型を新たに定義するのが良いでしょう。そのようにすると、他の interface も実装する必要があります。\n結論から言うと https://github.com/ent/contrib/blob/6623819401500db45747a2419172963217cef619/entgql/internal/todopulid/ent/schema/pulid/pulid.go にそのものの実装があります1。この実装はライブラリ化されているものではない（ internal ）ので、そのままコピペして利用するのが良いでしょう。\n使用する場合には以下のようになります。\n// Fields of the User.\nfunc (User) Fields() []ent.Field {\n    return []ent.Field{\n        field.String(\"id\").\n            GoType(pulid.ID(\"\")).\n            DefaultFunc(func() pulid.ID { return pulid.MustNew(\"US\") }),\n        field.Int(\"age\").Positive(),\n        field.String(\"name\").Default(\"unknown\"),\n    }\n}\n\n\n\nprefixが不要な場合はprefixの部分を削ってしまうのが良いかと思います。\nこのままの実装でもう少し手軽に書きたい場合は、同リポジトリに mixin が存在しますので、これを持ち出すと良いと思います。\nent は各フィールドを固有の型にできますので、例えば上記例で ID を UserID 型にしたい場合は以下のようになります。\ntype UserID pulid.ID\n\n// Fields of the User.\nfunc (User) Fields() []ent.Field {\n    return []ent.Field{\n        field.String(\"id\").\n            GoType(UserID(\"\")).\n            DefaultFunc(func() UserID { return UserID(pulid.MustNew(\"US\")) }),\n        field.Int(\"age\").Positive(),\n        field.String(\"name\").Default(\"unknown\"),\n    }\n}\n\n\n\n\n\n\nhttps://github.com/tmc/pulid のように見えるのですが、こちらは Value() はバイナリを返すようです。↩","id":"hatenablog://entry/26006613701103637","isoDate":"2021-03-09T03:00:00.000Z"},{"title":" Infrastructure as Codeは最初からやったほうがいい","link":"https://nazo.hatenablog.com/entry/iac-first","pubDate":"2021-03-08T03:00:00.000Z","author":"nazone","content":"\u003cp\u003e最近不慣れな \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GCP\"\u003eGCP\u003c/a\u003e を触ることがあったのですが、最初から Terraform で書くようにしたほうが楽だったので、それについて解説しようと思います。\u003c/p\u003e\n\n\u003ch1\u003eWeb のコンソールを触るのが怖い\u003c/h1\u003e\n\n\u003cp\u003e他のサービスが同居しているアカウントでインフラを操作すると、他のサービスに影響を与えてしまうのでは…という不安があります。関係のないサービスは別アカウントにするというのがベストプ\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E9%A5%AF\"\u003eラク\u003c/a\u003eティスですが、様々な事情によりそれができない場合もあります。\u003c/p\u003e\n\n\u003cp\u003e最初から IaC で触っていれば、コードで生成したインフラ以外を触ることがなく、削除する時も間違えることがなく削除することができ、何度も作り直して試すことが容易になります。\u003c/p\u003e\n\n\u003ch1\u003e手順を覚えられない\u003c/h1\u003e\n\n\u003cp\u003eWebのコンソールでも、\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%DE%A5%F3%A5%C9%A5%E9%A5%A4%A5%F3\"\u003eコマンドライン\u003c/a\u003eツールでも同様ですが、作業した内容を記録しておく必要があります。記録していない場合、同じ環境を再現することができません。\u003c/p\u003e\n\n\u003cp\u003e最初からコード化をしていれば、手順を覚えておく必要もありません。\u003c/p\u003e\n\n\u003ch1\u003e必要な依存関係を最初から教えてくれる\u003c/h1\u003e\n\n\u003cp\u003eコンソールで触っていると、どのサービスとどのサービスが繋がっているかというのがわかりにくいですが、例えば Terraform では必須パラメーターとして存在していることが多く、依存関係を設定していないと適用する前にエラーになってくれたりするので迷うことが少なくなります。\u003c/p\u003e\n\n\u003cp\u003eまた、サンプルで組み合わせた書き方が充実していたり、組み合わせサンプルのコードが用意されていたりするので、手順を読んで試行錯誤するより確実にインフラ構築をすることができます。\u003c/p\u003e\n\n\u003cp\u003e特に \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\"\u003eAWS\u003c/a\u003e で CDK や Copilot といったツールを使っておくと、複雑なサービス間の依存関係を考えることがなく構成を立ち上げることができます。\u003c/p\u003e\n\n\u003ch1\u003e設定できるパラメーターがツールのドキュメントに網羅されている\u003c/h1\u003e\n\n\u003cp\u003e依存関係と同様に、全てのパラメーターがドキュメントに書かれているので、「このリソースではこれが設定できる」とか「このリソースはこの設定をすることができない」というのがドキュメントを読むだけで把握することができます。\u003c/p\u003e\n\n\u003cp\u003eただし \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/GCP\"\u003eGCP\u003c/a\u003e の Cloud Run のような\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E1%A5%BF%A5%C7%A1%BC%A5%BF\"\u003eメタデータ\u003c/a\u003eでパラメーターを指定するような類のものの場合や、\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\"\u003eAWS\u003c/a\u003e RDS のパラメーターグループのような任意のものを指定するようなものはドキュメントには書かれていないので、そこはオフィシャルのドキュメントやコンソールの画面を併せて読む必要があります。\u003c/p\u003e\n\n\u003ch1\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eコンソールで試行錯誤するより、最初からコードで書いて試行錯誤したほうが良いことが多いです。手作業を後からコード化するのは二度手間にもなるので、学習目的とかでない限りは最初からコードを書きましょう。\u003c/p\u003e\n\n\u003cp\u003eもちろんある程度の IaC ツールに慣れておく必要や、\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%AF%A5%E9%A5%A6%A5%C9\"\u003eクラウド\u003c/a\u003eインフラの使い方に慣れておく必要がありますので、そこは基礎教養として素振りしておきましょう。\u003c/p\u003e\n","contentSnippet":"最近不慣れな GCP を触ることがあったのですが、最初から Terraform で書くようにしたほうが楽だったので、それについて解説しようと思います。\nWeb のコンソールを触るのが怖い\n他のサービスが同居しているアカウントでインフラを操作すると、他のサービスに影響を与えてしまうのでは…という不安があります。関係のないサービスは別アカウントにするというのがベストプラクティスですが、様々な事情によりそれができない場合もあります。\n最初から IaC で触っていれば、コードで生成したインフラ以外を触ることがなく、削除する時も間違えることがなく削除することができ、何度も作り直して試すことが容易になります。\n手順を覚えられない\nWebのコンソールでも、コマンドラインツールでも同様ですが、作業した内容を記録しておく必要があります。記録していない場合、同じ環境を再現することができません。\n最初からコード化をしていれば、手順を覚えておく必要もありません。\n必要な依存関係を最初から教えてくれる\nコンソールで触っていると、どのサービスとどのサービスが繋がっているかというのがわかりにくいですが、例えば Terraform では必須パラメーターとして存在していることが多く、依存関係を設定していないと適用する前にエラーになってくれたりするので迷うことが少なくなります。\nまた、サンプルで組み合わせた書き方が充実していたり、組み合わせサンプルのコードが用意されていたりするので、手順を読んで試行錯誤するより確実にインフラ構築をすることができます。\n特に AWS で CDK や Copilot といったツールを使っておくと、複雑なサービス間の依存関係を考えることがなく構成を立ち上げることができます。\n設定できるパラメーターがツールのドキュメントに網羅されている\n依存関係と同様に、全てのパラメーターがドキュメントに書かれているので、「このリソースではこれが設定できる」とか「このリソースはこの設定をすることができない」というのがドキュメントを読むだけで把握することができます。\nただし GCP の Cloud Run のようなメタデータでパラメーターを指定するような類のものの場合や、AWS RDS のパラメーターグループのような任意のものを指定するようなものはドキュメントには書かれていないので、そこはオフィシャルのドキュメントやコンソールの画面を併せて読む必要があります。\nまとめ\nコンソールで試行錯誤するより、最初からコードで書いて試行錯誤したほうが良いことが多いです。手作業を後からコード化するのは二度手間にもなるので、学習目的とかでない限りは最初からコードを書きましょう。\nもちろんある程度の IaC ツールに慣れておく必要や、クラウドインフラの使い方に慣れておく必要がありますので、そこは基礎教養として素振りしておきましょう。","id":"hatenablog://entry/26006613698278372","isoDate":"2021-03-08T03:00:00.000Z"},{"title":"Webエンジニアが新規でプロジェクトに入った時に確認すること","link":"https://nazo.hatenablog.com/entry/project-onboarding","pubDate":"2021-03-03T03:00:00.000Z","author":"nazone","content":"\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EA%A1%BC%A5%E9%A5%F3%A5%B9\"\u003eフリーランス\u003c/a\u003eとしてWebエンジニアをしておりますが、プロジェクトに新規に入った時にどういう点を確認しているのかをまとめておきたいと思います。\u003c/p\u003e\n\n\u003ch1\u003eプロジェクトの目標と直近の目標が問題ないか\u003c/h1\u003e\n\n\u003cp\u003eプロジェクトの最終目標（理想）はとにかく大きくあるべきで、一方で直近の目標は具体的かつ十分に実現可能なサイズになっているべきです。もちろんその間くらいの目標（いわゆる\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%DE%A5%A4%A5%EB%A5%B9%A5%C8%A1%BC%A5%F3\"\u003eマイルストーン\u003c/a\u003e）も存在しているはずです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EA%A1%BC%A5%E9%A5%F3%A5%B9\"\u003eフリーランス\u003c/a\u003eの立場だと目標そのものに直接口を出すことはないですが、直近の目標が大きすぎると手を動かす時に困ってしまいますので、どこを削ぎ落とすのが良いのかこちらから提案することはあります。\u003c/p\u003e\n\n\u003ch1\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B3%AB%C8%AF%A5%D7%A5%ED%A5%BB%A5%B9\"\u003e開発プロセス\u003c/a\u003eが問題ないか\u003c/h1\u003e\n\n\u003cp\u003eプロジェクト参加直後はベロシティ（スプリント期間内の平均作業量）が不安定ですので、そこを許容できてちゃんと\u003c/p\u003e\n\n\u003cp\u003e個人的には常に\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%E9%A5%E0\"\u003eスクラム\u003c/a\u003eである必要はないと思いますが、マネージャーがいる場合はマネージャーが各メンバーのベロシティをちゃんと把握している、不在の場合は自分でベロシティが把握できていてタスクの見積もりができる、という状況になっていれば良いかと思います。「何だかよくわからないタスクをよくわからない期間で対応している」という状況では、前述の直近の目標の提案と同時に対処方法の提案を行うこともあります。\u003c/p\u003e\n\n\u003ch1\u003eデプロイが安定かつ高速に行えているか\u003c/h1\u003e\n\n\u003cp\u003eデプロイ速度は修正速度に直接繋がりますし、安定したデプロイができなければデプロイする単位が大きくなりがちですので、デプロイの安定性は最重要になります。\u003c/p\u003e\n\n\u003cp\u003e当然デプロイは完全自動化されていて、誰でも気軽に（承認フローなどは別として）デプロイできることが前提です。\u003c/p\u003e\n\n\u003cp\u003e誰でも簡単にデプロイできない場合、誰かにデプロイをお願いするというようなことが発生します。これでは自分と誰かの作業と、それを連絡する作業が増えてしまい、当然作業効率が悪くなってしまいますので、「誰でも」は重要です。「コマンド一発でデプロイできる」と見えても「（コマンドを実行する前にアクセスキーを取得して手元でデプロイ準備をして…）コマンド一発でデプロイできる」という場合がよくありますので、デプロイ環境自体が CI/CD 環境に移されていて手元の環境に影響せずデプロイできる（ CI サーバーが落ちていた場合は手元でも実行できる）というのが理想です。\u003c/p\u003e\n\n\u003ch1\u003eデプロイ方法が複雑になっていないか\u003c/h1\u003e\n\n\u003cp\u003e安定して高速にデプロイできていても、それを処理している方法が複雑だとメンテナンスの時に困ります。\u003c/p\u003e\n\n\u003cp\u003eメインのコードは綺麗にできてもインフラ系の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8\"\u003eスクリプト\u003c/a\u003eは長くなりがちみたいなケースはよく見かけますが、インフラ系の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8\"\u003eスクリプト\u003c/a\u003eもメインのコード同様に読みやすく構造化されているべきです。またインフラ系はツールが充実していることが多いので、なるべく自分で書く\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B9%A5%AF%A5%EA%A5%D7%A5%C8\"\u003eスクリプト\u003c/a\u003eは最小限にするのが良いと思います。\u003c/p\u003e\n\n\u003cp\u003eデプロイ自体が安定高速動作していればとりあえずは問題ないので、ここは後回しにすることも多いです。\u003c/p\u003e\n\n\u003ch1\u003eCI でコード品質が十分に守られているか\u003c/h1\u003e\n\n\u003cp\u003eCI の整備は後になればなるほど大変です。\u003csup id=\"fnref:1\"\u003e\u003ca href=\"#fn:1\" rel=\"footnote\"\u003e1\u003c/a\u003e\u003c/sup\u003eこれは CI で行うことの多くはコード品質そのものを一定の品質にする（ lint など）もののため、コード量が増えた後からそれを適用しようとすると修正点が膨大になるためです。\nlint はとにかくコード量が増える前に対処することが大事なので、ここは真っ先にチェックを行います。リリース前プロジェクトであればすぐ導入しますが、リリース後だと手を入れにくいので、最小限の設定にして少しずつ厳しくするという手法を採ります。\u003c/p\u003e\n\n\u003cp\u003e（自動）テストはそもそもテストが書けているかというのをまず確認しますが、その上で「テストに再現性があるか」「テストの内容が十分か」「\u003ca href=\"https://testing.googleblog.com/2010/12/test-sizes.html\"\u003eTest Sizes\u003c/a\u003e の分類が十分にできているか」といった内容を確認します。\u003c/p\u003e\n\n\u003cp\u003e数回に１回落ちるようなテストがある場合で、それがテストの実行順に影響している場合はテストの書き方そのものに問題がある場合がほとんどですので、その場合は削除してしまったほうが良いことが多いです。一方で、時間に関わるテストや、乱数や\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%BF%F4%C3%CD%B7%D7%BB%BB\"\u003e数値計算\u003c/a\u003eの誤差などが影響するようなテストは、それ自体が重要なケースが多いのでちゃんと調査したほうがいいと思います。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://testing.googleblog.com/2010/12/test-sizes.html\"\u003eTest Sizes\u003c/a\u003e は、テストの分類を「\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C3%B1%C2%CE%A5%C6%A5%B9%A5%C8\"\u003e単体テスト\u003c/a\u003e」「\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B7%EB%B9%E7%A5%C6%A5%B9%A5%C8\"\u003e結合テスト\u003c/a\u003e」といった曖昧な呼び方ではなく、「我々のプロジェクトでは３段階の分類があり、それぞれのレベルではこうなっている」というものをプロジェクト固有で定義しようというものです。\u003c/p\u003e\n\n\u003ch1\u003eローカルでの環境構築が問題なく行えるか\u003c/h1\u003e\n\n\u003cp\u003e自分が受け入れられる側になるのですが、この時に受け入れ準備が十分にできているか確認し、できていない場合は改善しながら作業することになります。\u003c/p\u003e\n\n\u003cp\u003e一番ありがちなのは環境構築手順が整備されていないということで、これは自分がそのまま作業するのですぐわかります。\u003c/p\u003e\n\n\u003cp\u003eローカルの開発に外部のサーバーが必要な場合はまずそれがローカルで再現できないのか確認します。単なる \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/MySQL\"\u003eMySQL\u003c/a\u003e や \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/PostgreSQL\"\u003ePostgreSQL\u003c/a\u003e などをサーバーに繋いでいる場合はローカルで立ち上げるように変更します。\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%DF%A5%E5%A5%EC%A1%BC%A5%BF%A1%BC\"\u003eエミュレーター\u003c/a\u003eが用意されているサービスであればそちらを使うようにします。この際に設定が直接書かれていたり ENV などでの切り替えしか対応していない場合は、設定を\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%B4%C4%B6%AD%CA%D1%BF%F4\"\u003e環境変数\u003c/a\u003eに出して変更可能にします。\u003csup id=\"fnref:2\"\u003e\u003ca href=\"#fn:2\" rel=\"footnote\"\u003e2\u003c/a\u003e\u003c/sup\u003e\n最近だと自分は M1 (\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Apple\"\u003eApple\u003c/a\u003e Silicon) \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Mac\"\u003eMac\u003c/a\u003e を使用しているので、この環境で動作しないものを使っているという場面に遭遇することもあります。この場合は Docker 化を真っ先に行います。\u003c/p\u003e\n\n\u003cp\u003e手順はあるけど手順通りにやっても上手く行かないという場合、「使っているライブラリのアップデートで動かなくなった」というケースと「プログラムの構造の変化に対応していない」というケースが多いです。どちらにしても変更を把握できていないということが原因ですので、メンテナンス体制に難があることが多いです。外部ライブラリの更新などは把握しておく、自分で修正した場合は環境構築手順もアップデートするフローにしておく、ということが必要になります。\u003c/p\u003e\n\n\u003ch1\u003e受け入れタスクが十分に実施可能な内容になっているか\u003c/h1\u003e\n\n\u003cp\u003eここでの障害は「ライブラリやツールの使い方が独自性の強いものになっていないか」「暗黙の知識が多用されていないか」といったものがあります。もちろん前述までの内容がクリアになっていないと作業に入ることもできませんので、それらを取り除いた後にようやく作業ができるということになります。\u003c/p\u003e\n\n\u003cp\u003e「ライブラリやツールの使い方が独自性の強いものになっていないか」というのは、自作ライブラリとかを使っている場合は当然ですが、ベストプ\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%E9%A5%AF\"\u003eラク\u003c/a\u003eティスに即していないようなライブラリの使い方をしているとか、\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%CB%E2%B2%FE%C2%A4\"\u003e魔改造\u003c/a\u003eされているというような場合には、なるべく本来の使い方に戻すよう指摘することがあります。「ライブラリやツールの公式の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C1%A5%E5%A1%BC%A5%C8%A5%EA%A5%A2%A5%EB\"\u003eチュートリアル\u003c/a\u003eを見た上でそれを使っている部分を読んだ時にすぐ理解できるようになっているか」というのが指標になります。\u003c/p\u003e\n\n\u003cp\u003e「暗黙の知識が多用されていないか」はそのままですが、プロジェクト固有の暗黙の知識がある場合は当然手を入れることができません。暗黙の知識が登場する場合はコメントなどで把握できるようになっていること、仕様と実態の乖離がないことなどを確認します。\u003c/p\u003e\n\n\u003ch1\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eこれらの点がクリアされているプロジェクトであれば、新しく人を入れることも容易ですし、引き継ぎの時にも困らないのではないかと思います。\u003c/p\u003e\n\n\u003cp\u003e書き漏れがあるかもしれないので、思い出したら追記する可能性があります。\u003c/p\u003e\n\n\u003cp\u003e今回はインフラの話は除外しましたが、インフラでチェックする点もまた機会があればまとめてみたいと思います。\u003c/p\u003e\n\n\u003cp\u003eこれらの点でお悩みの方は是非私までご相談をお願いします。詳細は \u003ca href=\"https://nazo.dev/profile\"\u003ehttps://nazo.dev/profile\u003c/a\u003e をご覧下さい。\u003c/p\u003e\n\u003cdiv class=\"footnotes\"\u003e\n\u003chr/\u003e\n\u003col\u003e\n\u003cli id=\"fn:1\"\u003e\n\u003cp\u003e\u003ca href=\"https://www.slideshare.net/nazone/ss-205324165\"\u003ehttps://www.slideshare.net/nazone/ss-205324165\u003c/a\u003e もご覧下さい。\u003ca href=\"#fnref:1\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003cli id=\"fn:2\"\u003e\n\u003cp\u003e\u003ca href=\"https://12factor.net/ja/config\"\u003ehttps://12factor.net/ja/config\u003c/a\u003e\u003ca href=\"#fnref:2\" rev=\"footnote\"\u003e\u0026#8617;\u003c/a\u003e\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003c/div\u003e\n\n","contentSnippet":"フリーランスとしてWebエンジニアをしておりますが、プロジェクトに新規に入った時にどういう点を確認しているのかをまとめておきたいと思います。\nプロジェクトの目標と直近の目標が問題ないか\nプロジェクトの最終目標（理想）はとにかく大きくあるべきで、一方で直近の目標は具体的かつ十分に実現可能なサイズになっているべきです。もちろんその間くらいの目標（いわゆるマイルストーン）も存在しているはずです。\nフリーランスの立場だと目標そのものに直接口を出すことはないですが、直近の目標が大きすぎると手を動かす時に困ってしまいますので、どこを削ぎ落とすのが良いのかこちらから提案することはあります。\n開発プロセスが問題ないか\nプロジェクト参加直後はベロシティ（スプリント期間内の平均作業量）が不安定ですので、そこを許容できてちゃんと\n個人的には常にスクラムである必要はないと思いますが、マネージャーがいる場合はマネージャーが各メンバーのベロシティをちゃんと把握している、不在の場合は自分でベロシティが把握できていてタスクの見積もりができる、という状況になっていれば良いかと思います。「何だかよくわからないタスクをよくわからない期間で対応している」という状況では、前述の直近の目標の提案と同時に対処方法の提案を行うこともあります。\nデプロイが安定かつ高速に行えているか\nデプロイ速度は修正速度に直接繋がりますし、安定したデプロイができなければデプロイする単位が大きくなりがちですので、デプロイの安定性は最重要になります。\n当然デプロイは完全自動化されていて、誰でも気軽に（承認フローなどは別として）デプロイできることが前提です。\n誰でも簡単にデプロイできない場合、誰かにデプロイをお願いするというようなことが発生します。これでは自分と誰かの作業と、それを連絡する作業が増えてしまい、当然作業効率が悪くなってしまいますので、「誰でも」は重要です。「コマンド一発でデプロイできる」と見えても「（コマンドを実行する前にアクセスキーを取得して手元でデプロイ準備をして…）コマンド一発でデプロイできる」という場合がよくありますので、デプロイ環境自体が CI/CD 環境に移されていて手元の環境に影響せずデプロイできる（ CI サーバーが落ちていた場合は手元でも実行できる）というのが理想です。\nデプロイ方法が複雑になっていないか\n安定して高速にデプロイできていても、それを処理している方法が複雑だとメンテナンスの時に困ります。\nメインのコードは綺麗にできてもインフラ系のスクリプトは長くなりがちみたいなケースはよく見かけますが、インフラ系のスクリプトもメインのコード同様に読みやすく構造化されているべきです。またインフラ系はツールが充実していることが多いので、なるべく自分で書くスクリプトは最小限にするのが良いと思います。\nデプロイ自体が安定高速動作していればとりあえずは問題ないので、ここは後回しにすることも多いです。\nCI でコード品質が十分に守られているか\nCI の整備は後になればなるほど大変です。1これは CI で行うことの多くはコード品質そのものを一定の品質にする（ lint など）もののため、コード量が増えた後からそれを適用しようとすると修正点が膨大になるためです。\nlint はとにかくコード量が増える前に対処することが大事なので、ここは真っ先にチェックを行います。リリース前プロジェクトであればすぐ導入しますが、リリース後だと手を入れにくいので、最小限の設定にして少しずつ厳しくするという手法を採ります。\n（自動）テストはそもそもテストが書けているかというのをまず確認しますが、その上で「テストに再現性があるか」「テストの内容が十分か」「Test Sizes の分類が十分にできているか」といった内容を確認します。\n数回に１回落ちるようなテストがある場合で、それがテストの実行順に影響している場合はテストの書き方そのものに問題がある場合がほとんどですので、その場合は削除してしまったほうが良いことが多いです。一方で、時間に関わるテストや、乱数や数値計算の誤差などが影響するようなテストは、それ自体が重要なケースが多いのでちゃんと調査したほうがいいと思います。\nTest Sizes は、テストの分類を「単体テスト」「結合テスト」といった曖昧な呼び方ではなく、「我々のプロジェクトでは３段階の分類があり、それぞれのレベルではこうなっている」というものをプロジェクト固有で定義しようというものです。\nローカルでの環境構築が問題なく行えるか\n自分が受け入れられる側になるのですが、この時に受け入れ準備が十分にできているか確認し、できていない場合は改善しながら作業することになります。\n一番ありがちなのは環境構築手順が整備されていないということで、これは自分がそのまま作業するのですぐわかります。\nローカルの開発に外部のサーバーが必要な場合はまずそれがローカルで再現できないのか確認します。単なる MySQL や PostgreSQL などをサーバーに繋いでいる場合はローカルで立ち上げるように変更します。エミュレーターが用意されているサービスであればそちらを使うようにします。この際に設定が直接書かれていたり ENV などでの切り替えしか対応していない場合は、設定を環境変数に出して変更可能にします。2\n最近だと自分は M1 (Apple Silicon) Mac を使用しているので、この環境で動作しないものを使っているという場面に遭遇することもあります。この場合は Docker 化を真っ先に行います。\n手順はあるけど手順通りにやっても上手く行かないという場合、「使っているライブラリのアップデートで動かなくなった」というケースと「プログラムの構造の変化に対応していない」というケースが多いです。どちらにしても変更を把握できていないということが原因ですので、メンテナンス体制に難があることが多いです。外部ライブラリの更新などは把握しておく、自分で修正した場合は環境構築手順もアップデートするフローにしておく、ということが必要になります。\n受け入れタスクが十分に実施可能な内容になっているか\nここでの障害は「ライブラリやツールの使い方が独自性の強いものになっていないか」「暗黙の知識が多用されていないか」といったものがあります。もちろん前述までの内容がクリアになっていないと作業に入ることもできませんので、それらを取り除いた後にようやく作業ができるということになります。\n「ライブラリやツールの使い方が独自性の強いものになっていないか」というのは、自作ライブラリとかを使っている場合は当然ですが、ベストプラクティスに即していないようなライブラリの使い方をしているとか、魔改造されているというような場合には、なるべく本来の使い方に戻すよう指摘することがあります。「ライブラリやツールの公式のチュートリアルを見た上でそれを使っている部分を読んだ時にすぐ理解できるようになっているか」というのが指標になります。\n「暗黙の知識が多用されていないか」はそのままですが、プロジェクト固有の暗黙の知識がある場合は当然手を入れることができません。暗黙の知識が登場する場合はコメントなどで把握できるようになっていること、仕様と実態の乖離がないことなどを確認します。\nまとめ\nこれらの点がクリアされているプロジェクトであれば、新しく人を入れることも容易ですし、引き継ぎの時にも困らないのではないかと思います。\n書き漏れがあるかもしれないので、思い出したら追記する可能性があります。\n今回はインフラの話は除外しましたが、インフラでチェックする点もまた機会があればまとめてみたいと思います。\nこれらの点でお悩みの方は是非私までご相談をお願いします。詳細は https://nazo.dev/profile をご覧下さい。\nhttps://www.slideshare.net/nazone/ss-205324165 もご覧下さい。↩\n\n\nhttps://12factor.net/ja/config↩","id":"hatenablog://entry/26006613698182809","isoDate":"2021-03-03T03:00:00.000Z"},{"title":"M1(Apple Silicon) Mac に google-cloud-sdk を無理やりインストールする（2021/01/19時点）","link":"https://nazo.hatenablog.com/entry/2021/01/19/115358","pubDate":"2021-01-19T02:53:58.000Z","author":"nazone","content":"\u003cp\u003e\u003ca href=\"https://cloud.google.com/sdk/docs/quickstart-macos?hl=ja\"\u003e公式からダウンロードしてきた tarball\u003c/a\u003e からインストールすると以下のエラーが出ます。\u003c/p\u003e\n\n\u003cpre class=\"code lang-sh\" data-lang=\"sh\" data-unlink\u003e/google-cloud-sdk ❯❯❯ ./install.sh\nWelcome to the Google Cloud SDK!\nTraceback \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003emost recent call last\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e:\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/Users/nazo/google-cloud-sdk/bin/bootstrapping/install.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e12\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    import bootstrapping\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/Users/nazo/google-cloud-sdk/bin/bootstrapping/bootstrapping.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e32\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    import setup  \u003cspan class=\"synComment\"\u003e# pylint:disable=g-import-not-at-top\u003c/span\u003e\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/Users/nazo/google-cloud-sdk/bin/bootstrapping/setup.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e57\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    from googlecloudsdk.core.util import platforms\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/Users/nazo/google-cloud-sdk/lib/googlecloudsdk/__init__.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    from googlecloudsdk.core.util import importing\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/Users/nazo/google-cloud-sdk/lib/googlecloudsdk/core/util/importing.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    import imp\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/imp.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e23\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    from importlib import util\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/util.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    from\u003cspan class=\"synStatement\"\u003e . \u003c/span\u003eimport abc\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/abc.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e17\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    from typing import Protocol, runtime_checkable\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/typing.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e26\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    import re as stdlib_re  \u003cspan class=\"synComment\"\u003e# Avoid confusion with the re we export.\u003c/span\u003e\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/re.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e124\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    import enum\n  File \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003e/Users/nazo/google-cloud-sdk/lib/third_party/enum/__init__.py\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, line \u003cspan class=\"synConstant\"\u003e26\u003c/span\u003e, \u003cspan class=\"synError\"\u003ein\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003emodule\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e\n    spec \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e importlib.util.find_spec\u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003eenum\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e\nAttributeError: module \u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003eimportlib\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e has no attribute \u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003eutil\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/curl\"\u003ecurl\u003c/a\u003e でインストールするともう少し進みますが以下のエラーが出ます。\u003c/p\u003e\n\n\u003cpre class=\"code lang-sh\" data-lang=\"sh\" data-unlink\u003e~ ❯❯❯ curl https://sdk.cloud.google.com | bash\n（略）\nWelcome to the Google Cloud SDK!\n\nTo \u003cspan class=\"synStatement\"\u003ehelp\u003c/span\u003e improve the quality of this product, we collect anonymized usage data\nand anonymized stacktraces when crashes are encountered; additional information\nis available at \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003ehttps://cloud.google.com/sdk/usage-statistics\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e. This data is\nhandled \u003cspan class=\"synError\"\u003ein\u003c/span\u003e accordance with our privacy policy\n\u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003ehttps://cloud.google.com/terms/cloud-privacy-notice\u003cspan class=\"synStatement\"\u003e\u0026gt;\u003c/span\u003e. You may choose to opt \u003cspan class=\"synError\"\u003ein\u003c/span\u003e this\ncollection now \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003eby choosing \u003c/span\u003e\u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\u003cspan class=\"synConstant\"\u003eY\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e'\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003e at the below prompt\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e, or at any \u003cspan class=\"synStatement\"\u003etime\u003c/span\u003e \u003cspan class=\"synError\"\u003ein\u003c/span\u003e the\nfuture by running the following command:\n\n    gcloud config \u003cspan class=\"synStatement\"\u003eset\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e disable_usage_reporting false\u003c/span\u003e\n\nDo you want to \u003cspan class=\"synStatement\"\u003ehelp\u003c/span\u003e improve the Google Cloud SDK \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003ey/N\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e?\n\n\nThis will install all the core \u003cspan class=\"synStatement\"\u003ecommand\u003c/span\u003e line tools necessary \u003cspan class=\"synStatement\"\u003efor\u003c/span\u003e working with\nthe Google Cloud Platform.\n\nBeginning update. This process may take several minutes.\nERROR: \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003egcloud.components.update\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e The following components are unknown \u003cspan class=\"synStatement\"\u003e[\u003c/span\u003eanthoscli, kuberun\u003cspan class=\"synStatement\"\u003e]\u003c/span\u003e.\n\u003c/pre\u003e\n\n\n\u003cp\u003eこれは \u003ccode\u003eanthoscli\u003c/code\u003e \u003ccode\u003ekuberun\u003c/code\u003e の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%B3%A5%F3%A5%DD%A1%BC%A5%CD%A5%F3%A5%C8\"\u003eコンポーネント\u003c/a\u003eがインストールできない（ \u003ccode\u003egcloud components install anthoscli kuberun\u003c/code\u003e と同等）のが原因です。\u003c/p\u003e\n\n\u003cp\u003e回避するには、\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/curl\"\u003ecurl\u003c/a\u003e で上記エラーが出た時点で \u003ccode\u003e~/google-cloud-sdk\u003c/code\u003e にファイル一式があるはずなので、移動して以下のように実行します。\u003c/p\u003e\n\n\u003cpre class=\"code lang-sh\" data-lang=\"sh\" data-unlink\u003e~/google-cloud-sdk ❯❯❯ ./install.sh \u003cspan class=\"synSpecial\"\u003e--override-components\u003c/span\u003e core gcloud-deps bq gcloud gsutil\nWelcome to the Google Cloud SDK!\n\n（略）\n\nYour current Cloud SDK version is: \u003cspan class=\"synConstant\"\u003e323\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\nInstalling components from version: \u003cspan class=\"synConstant\"\u003e323\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e\n\n┌────────────────────────────────────────────────────────────────────────────┐\n│                    These components will be installed.                     │\n├─────────────────────────────────────────────────────┬────────────┬─────────┤\n│                         Name                        │  Version   │   Size  │\n├─────────────────────────────────────────────────────┼────────────┼─────────┤\n│ BigQuery Command Line Tool                          │     \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e64\u003c/span\u003e │ \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e MiB │\n│ BigQuery Command Line Tool \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003ePlatform Specific\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e      │     \u003cspan class=\"synConstant\"\u003e2\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e0\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e58\u003c/span\u003e │ \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e MiB │\n│ Cloud SDK Core Libraries \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003ePlatform Specific\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e        │ \u003cspan class=\"synConstant\"\u003e2020\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e07\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e10\u003c/span\u003e │ \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e MiB │\n│ Cloud Storage Command Line Tool                     │       \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e57\u003c/span\u003e │ \u003cspan class=\"synConstant\"\u003e3\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e5\u003c/span\u003e MiB │\n│ Cloud Storage Command Line Tool \u003cspan class=\"synPreProc\"\u003e(\u003c/span\u003e\u003cspan class=\"synSpecial\"\u003ePlatform Specific\u003c/span\u003e\u003cspan class=\"synPreProc\"\u003e)\u003c/span\u003e │       \u003cspan class=\"synConstant\"\u003e4\u003c/span\u003e.\u003cspan class=\"synConstant\"\u003e51\u003c/span\u003e │ \u003cspan class=\"synStatement\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e1\u003c/span\u003e MiB │\n└─────────────────────────────────────────────────────┴────────────┴─────────┘\n\nFor the latest full release notes, please visit:\n  https://cloud.google.com/sdk/release_notes\n\n（略）\n\nFor more information on how to get started, please visit:\n  https://cloud.google.com/sdk/docs/quickstarts\n\u003c/pre\u003e\n\n\n\u003cp\u003eインストールに成功しました。\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003eoverride-components\u003c/code\u003e で指定した引数は、以下で確認したものからエラーが出るものを抜いたものになります。\u003c/p\u003e\n\n\u003cpre class=\"code lang-sh\" data-lang=\"sh\" data-unlink\u003e~/google-cloud-sdk ❯❯❯ cat bin/bootstrapping/.default_components\n\u003cspan class=\"synStatement\"\u003e[\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003ecore\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003egcloud-deps\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003ebq\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003egcloud\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003egsutil\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003eanthoscli\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e, \u003cspan class=\"synStatement\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"synConstant\"\u003ekuberun\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e\u0026quot;]\u003c/span\u003e%\n\u003c/pre\u003e\n\n\n\u003cp\u003eanthoscli も kuberun も、おそらく無くて困る人は多くないのではないかと思いますので、抜いてインストールしてしまっていいと思います。\u003c/p\u003e\n","contentSnippet":"公式からダウンロードしてきた tarball からインストールすると以下のエラーが出ます。\n/google-cloud-sdk ❯❯❯ ./install.sh\nWelcome to the Google Cloud SDK!\nTraceback (most recent call last):\n  File \"/Users/nazo/google-cloud-sdk/bin/bootstrapping/install.py\", line 12, in \u003cmodule\u003e\n    import bootstrapping\n  File \"/Users/nazo/google-cloud-sdk/bin/bootstrapping/bootstrapping.py\", line 32, in \u003cmodule\u003e\n    import setup  # pylint:disable=g-import-not-at-top\n  File \"/Users/nazo/google-cloud-sdk/bin/bootstrapping/setup.py\", line 57, in \u003cmodule\u003e\n    from googlecloudsdk.core.util import platforms\n  File \"/Users/nazo/google-cloud-sdk/lib/googlecloudsdk/__init__.py\", line 23, in \u003cmodule\u003e\n    from googlecloudsdk.core.util import importing\n  File \"/Users/nazo/google-cloud-sdk/lib/googlecloudsdk/core/util/importing.py\", line 23, in \u003cmodule\u003e\n    import imp\n  File \"/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/imp.py\", line 23, in \u003cmodule\u003e\n    from importlib import util\n  File \"/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/util.py\", line 2, in \u003cmodule\u003e\n    from . import abc\n  File \"/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/importlib/abc.py\", line 17, in \u003cmodule\u003e\n    from typing import Protocol, runtime_checkable\n  File \"/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/typing.py\", line 26, in \u003cmodule\u003e\n    import re as stdlib_re  # Avoid confusion with the re we export.\n  File \"/opt/homebrew/Cellar/python@3.9/3.9.1_6/Frameworks/Python.framework/Versions/3.9/lib/python3.9/re.py\", line 124, in \u003cmodule\u003e\n    import enum\n  File \"/Users/nazo/google-cloud-sdk/lib/third_party/enum/__init__.py\", line 26, in \u003cmodule\u003e\n    spec = importlib.util.find_spec('enum')\nAttributeError: module 'importlib' has no attribute 'util'\n\n\n\ncurl でインストールするともう少し進みますが以下のエラーが出ます。\n~ ❯❯❯ curl https://sdk.cloud.google.com | bash\n（略）\nWelcome to the Google Cloud SDK!\n\nTo help improve the quality of this product, we collect anonymized usage data\nand anonymized stacktraces when crashes are encountered; additional information\nis available at \u003chttps://cloud.google.com/sdk/usage-statistics\u003e. This data is\nhandled in accordance with our privacy policy\n\u003chttps://cloud.google.com/terms/cloud-privacy-notice\u003e. You may choose to opt in this\ncollection now (by choosing 'Y' at the below prompt), or at any time in the\nfuture by running the following command:\n\n    gcloud config set disable_usage_reporting false\n\nDo you want to help improve the Google Cloud SDK (y/N)?\n\n\nThis will install all the core command line tools necessary for working with\nthe Google Cloud Platform.\n\nBeginning update. This process may take several minutes.\nERROR: (gcloud.components.update) The following components are unknown [anthoscli, kuberun].\n\n\n\nこれは anthoscli kuberun のコンポーネントがインストールできない（ gcloud components install anthoscli kuberun と同等）のが原因です。\n回避するには、curl で上記エラーが出た時点で ~/google-cloud-sdk にファイル一式があるはずなので、移動して以下のように実行します。\n~/google-cloud-sdk ❯❯❯ ./install.sh --override-components core gcloud-deps bq gcloud gsutil\nWelcome to the Google Cloud SDK!\n\n（略）\n\nYour current Cloud SDK version is: 323.0.0\nInstalling components from version: 323.0.0\n\n┌────────────────────────────────────────────────────────────────────────────┐\n│                    These components will be installed.                     │\n├─────────────────────────────────────────────────────┬────────────┬─────────┤\n│                         Name                        │  Version   │   Size  │\n├─────────────────────────────────────────────────────┼────────────┼─────────┤\n│ BigQuery Command Line Tool                          │     2.0.64 │ \u003c 1 MiB │\n│ BigQuery Command Line Tool (Platform Specific)      │     2.0.58 │ \u003c 1 MiB │\n│ Cloud SDK Core Libraries (Platform Specific)        │ 2020.07.10 │ \u003c 1 MiB │\n│ Cloud Storage Command Line Tool                     │       4.57 │ 3.5 MiB │\n│ Cloud Storage Command Line Tool (Platform Specific) │       4.51 │ \u003c 1 MiB │\n└─────────────────────────────────────────────────────┴────────────┴─────────┘\n\nFor the latest full release notes, please visit:\n  https://cloud.google.com/sdk/release_notes\n\n（略）\n\nFor more information on how to get started, please visit:\n  https://cloud.google.com/sdk/docs/quickstarts\n\n\n\nインストールに成功しました。\noverride-components で指定した引数は、以下で確認したものからエラーが出るものを抜いたものになります。\n~/google-cloud-sdk ❯❯❯ cat bin/bootstrapping/.default_components\n[\"core\", \"gcloud-deps\", \"bq\", \"gcloud\", \"gsutil\", \"anthoscli\", \"kuberun\"]%\n\n\n\nanthoscli も kuberun も、おそらく無くて困る人は多くないのではないかと思いますので、抜いてインストールしてしまっていいと思います。","id":"hatenablog://entry/26006613680230958","isoDate":"2021-01-19T02:53:58.000Z"},{"title":"2020年の仕事と技術の振り返り","link":"https://nazo.hatenablog.com/entry/2020-works","pubDate":"2020-12-23T03:00:00.000Z","author":"nazone","content":"\u003cul\u003e\n\u003cli\u003e2019年 : \u003ca href=\"https://nazo.hatenablog.com/entry/goodbye-uuum\"\u003ehttps://nazo.hatenablog.com/entry/goodbye-uuum\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e今年は合計2社にお世話になりました。ところで\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D5%A5%EA%A1%BC%A5%E9%A5%F3%A5%B9\"\u003eフリーランス\u003c/a\u003eで関わった会社名とか公表するものなのでしょうか？\u003c/p\u003e\n\n\u003ch1\u003e関わり方\u003c/h1\u003e\n\n\u003cp\u003e1社最大週2で、なるべく事業\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003eから遠いところをお手伝いする、というスタンスで働きました。事業\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003eに直接関わるものだと大抵はスピード感（主に緊急対応という意味で）が必要になるため、なるべくそこから遠いけど役に立つ内容で関われるものでお手伝いしております。\u003c/p\u003e\n\n\u003cp\u003e1社週2にしているのは、複数社の案件を同時に受けたいというのがありましたが、実際には私の\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%C3%CE%CC%BE%C5%D9\"\u003e知名度\u003c/a\u003eが足りなくそこまで仕事が回ってくることはありませんでした。数ヶ月だけ週2 x 2社の状態はありました。週5は疲れてしまうので当面はしない予定です。\u003c/p\u003e\n\n\u003cp\u003e原則として準委任契約による月額払いでの契約をお願いしております。これは私は一人でアプリを全部仕上げたりデザインを納品するような作業は得意としておらず、テクニカルな困りごとを\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%CE%D7%B5%A1%B1%FE%CA%D1\"\u003e臨機応変\u003c/a\u003eに対応するという内容を中心に活動しているためです。また原則フルリモートでお願いしております。\u003c/p\u003e\n\n\u003ch1\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\"\u003eRails\u003c/a\u003e によるアプリケーション開発 1社目\u003c/h1\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\"\u003eRails\u003c/a\u003e のバージョンを 4 -\u003e 5 に上げる仕事、同時に Webpacker のバージョンも同様に上げる仕事を中心に行いました。\u003c/p\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\"\u003eRails\u003c/a\u003e 側は元の書き方がそこそこ行儀が良い（ \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Rails\"\u003eRails\u003c/a\u003e そのものを\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%CB%E2%B2%FE%C2%A4\"\u003e魔改造\u003c/a\u003eしていない）ために問題になることは少なかったですが、Webpacker 側は動かないものが大量発生して大変でした。アップグレード作業は定形で引っかかる箇所もありますが、どちらかというと固有の事情を解決することが多そうなので、どれだけ全体を把握できるかが勝負になると思います。\u003c/p\u003e\n\n\u003ch1\u003eElixir ( \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Phoenix\"\u003ePhoenix\u003c/a\u003e ) + Vue ( Nuxt ) + \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\"\u003eAWS\u003c/a\u003e EKS によるアプリケーション開発\u003c/h1\u003e\n\n\u003cp\u003eElixir 全く書いたことなかったのに誘っていただいて貴重な経験ができました。今年はほぼこの案件を中心に動いていました。実稼働している \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/k8s\"\u003ek8s\u003c/a\u003e を触れたのも良い経験になりました。\u003c/p\u003e\n\n\u003cp\u003eElixir はパターンマッチが強力なため、今までとはちょっと考え方を変えて書かないといけないところもあり、頭の体操的な面白さがありました。一方で \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Erlang\"\u003eErlang\u003c/a\u003e/OTP 側がわからないと詰まるところもたまにあり、そのあたりの調査力はまだまだ不足していると感じました。あとドキュメントが少ないので大体\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%BD%A1%BC%A5%B9%A5%B3%A1%BC%A5%C9\"\u003eソースコード\u003c/a\u003eを直接追うことが多いのも大変かなと思います。利用者がもっと増えてほしいところです。\u003c/p\u003e\n\n\u003cp\u003eアプリケーション側以外で大きくやったこととしては、以下のようなものがあります。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e既存インフラの Terraform 化（Terraform Cloud）\u003c/li\u003e\n\u003cli\u003eExUnit でのテスト整備\u003c/li\u003e\n\u003cli\u003eLamnda@Edge での OIDC 認証\u003c/li\u003e\n\u003cli\u003eHeadless \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/CMS\"\u003eCMS\u003c/a\u003e の採用\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003e特に Terraform 化では、既存のインフラとの整合性を保ちつつ IaC しやすい構造を作るというところで多少矛盾が生じるところもあり、落とし所を見つけるのが大変でした。「ここはインポートしたけど新しく追加しないで！」というような感じのコメントを残したりすることでなるべく今後も秩序を維持できるように残しておきました。\u003c/p\u003e\n\n\u003cp\u003e前職で\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A2%A1%BC%A5%AD%A5%C6%A5%AF%A5%C1%A5%E3\"\u003eアーキテクチャ\u003c/a\u003e設計やCI/CD設計などを全て自分がやるしかなかった経験が生かされ、ある程度構成を見ただけで実用的なTerraform分割の道筋がすぐ見えるようになったと思います。またCI/CDワークフローも整備し、誰でも安全にデプロイできるようにしておきました。\u003c/p\u003e\n\n\u003ch1\u003eその他プライベートでやったようなこと\u003c/h1\u003e\n\n\u003ch2\u003eECSのタスクスケジューラをどうにかしたかった\u003c/h2\u003e\n\n\u003cp\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/AWS\"\u003eAWS\u003c/a\u003e ECSの\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D0%A5%C3%A5%C1%BD%E8%CD%FD\"\u003eバッチ処理\u003c/a\u003eをもう少し使いやすくできないかなーと試行錯誤し、Goでシンプルなスケジューラーでも書こうと思ったのですが、すぐにやる気が消えてしまったのでやめました。ECSの異常終了の検知が思ったより簡単だったのでそれでいいかなという感じもします。（ \u003ca href=\"https://nazo.hatenablog.com/entry/slack-notify-ecs-stopped-task\"\u003eAWS ECS\u0026#x306E;\u0026#x30BF;\u0026#x30B9;\u0026#x30AF;\u0026#x304C;\u0026#x7570;\u0026#x5E38;\u0026#x7D42;\u0026#x4E86;\u0026#x3057;\u0026#x305F;\u0026#x3089;\u0026#x30ED;\u0026#x30B0;URL\u0026#x4ED8;\u0026#x304D;\u0026#x3067;Slack\u0026#x306B;\u0026#x901A;\u0026#x77E5;\u0026#x3059;\u0026#x308B; - nazolabo\u003c/a\u003e ）\u003c/p\u003e\n\n\u003cp\u003e現在は MWAA（ \u003ca href=\"https://aws.amazon.com/jp/blogs/news/introducing-amazon-managed-workflows-for-apache-airflow-mwaa/\"\u003eAmazon Managed Workflows for Apache Airflow (MWAA) \u0026#x306E;\u0026#x3054;\u0026#x7D39;\u0026#x4ECB; | Amazon Web Services \u0026#x30D6;\u0026#x30ED;\u0026#x30B0;\u003c/a\u003e ）も存在し、Airflow側でもawslogsから実行結果を取得する機能が入っていますので（\u003ca href=\"https://note.com/dd_techblog/n/nfcc531d7587a\"\u003eAirflow\u0026#x306E;\u0026#x30BF;\u0026#x30B9;\u0026#x30AF;\u0026#x5B9F;\u0026#x884C;\u0026#x74B0;\u0026#x5883;\u0026#x3092;\u0026#x5206;\u0026#x96E2;\u0026#x3059;\u0026#x308B;\u0026#xFF5C;Dentsu Digital Tech Blog\u0026#xFF5C;note\u003c/a\u003e）、ECSのタスクスケジューリングでは機能不足な場合でも困ることはないのではないかと思います。\u003c/p\u003e\n\n\u003ch2\u003eVue 3.0 （というか composition \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\"\u003eAPI\u003c/a\u003e）\u003c/h2\u003e\n\n\u003cp\u003e使うかどうかわからないのですが、Vue/Nuxtの最新を追うためにいくつかコードを書いていました。 \u003ca href=\"https://github.com/nazo/binsen/pull/7\"\u003ehttps://github.com/nazo/binsen/pull/7\u003c/a\u003e\u003c/p\u003e\n\n\u003cp\u003e現在のVue/NuxtはReact/Nextの後追いになっている感じが強く、もともとNuxtのほうが実用性としては先行していたはずだったのにというところから、もっとReactとは違う良さを出していってほしいなという感じがします。とはいえ現時点でのフロントエンドはNextかNuxt以外は選択肢にはないと思います。\u003c/p\u003e\n\n\u003ch2\u003eWebAssembly\u003c/h2\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fnazo.hatenablog.com%2Fentry%2Frust-nes-wasm\" title=\"rust-nesをwasm化した - nazolabo\" class=\"embed-card embed-blogcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 190px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://nazo.hatenablog.com/entry/rust-nes-wasm\"\u003enazo.hatenablog.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003ch1\u003e感想と今後\u003c/h1\u003e\n\n\u003cp\u003e週2で開発業務は翌週に記憶が切れていることが多く、単純にもう1日やったほうがいいなと思うこと多かったので、事業\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003eから外れていてもなかなか厳しいと思いました。よほどピンポイントに専門的な内容を行う場合（技術顧問的な？）でない限り、週3はあったほうがいいのではないかと思います。\u003c/p\u003e\n\n\u003cp\u003e声をかけていただいた会社さんの中には良いポジションを提示してくれたところもあったのですが、週5・出勤あり・正社員でと言われるとお断りするしかないため、申し訳なく思うところもありました。とはいえ今の働き方が現時点では一番良いと思っているので、当面このままで続けていこうと思います。（将来的には変えるとは思います）\u003c/p\u003e\n\n\u003cp\u003eこちらから積極的に声をかけていないということもあり、残念ながら現在仕事が途切れてしまっている状態なので、現在積極的に仕事を募集しております。気軽にご連絡をお待ちしております。詳しくは \u003ca href=\"https://gist.github.com/nazo/a6042a1ce09ed470a63c9f37132fef7b\"\u003e\u0026#x30DD;\u0026#x30FC;\u0026#x30C8;\u0026#x30D5;\u0026#x30A9;\u0026#x30EA;\u0026#x30AA; \u0026middot; GitHub\u003c/a\u003e をご覧下さい。\u003c/p\u003e\n\n\u003cp\u003eそれでは来年も皆様宜しくお願い致します。\u003c/p\u003e\n","contentSnippet":"2019年 : https://nazo.hatenablog.com/entry/goodbye-uuum\n今年は合計2社にお世話になりました。ところでフリーランスで関わった会社名とか公表するものなのでしょうか？\n関わり方\n1社最大週2で、なるべく事業ドメインから遠いところをお手伝いする、というスタンスで働きました。事業ドメインに直接関わるものだと大抵はスピード感（主に緊急対応という意味で）が必要になるため、なるべくそこから遠いけど役に立つ内容で関われるものでお手伝いしております。\n1社週2にしているのは、複数社の案件を同時に受けたいというのがありましたが、実際には私の知名度が足りなくそこまで仕事が回ってくることはありませんでした。数ヶ月だけ週2 x 2社の状態はありました。週5は疲れてしまうので当面はしない予定です。\n原則として準委任契約による月額払いでの契約をお願いしております。これは私は一人でアプリを全部仕上げたりデザインを納品するような作業は得意としておらず、テクニカルな困りごとを臨機応変に対応するという内容を中心に活動しているためです。また原則フルリモートでお願いしております。\nRails によるアプリケーション開発 1社目\nRails のバージョンを 4 -\u003e 5 に上げる仕事、同時に Webpacker のバージョンも同様に上げる仕事を中心に行いました。\nRails 側は元の書き方がそこそこ行儀が良い（ Rails そのものを魔改造していない）ために問題になることは少なかったですが、Webpacker 側は動かないものが大量発生して大変でした。アップグレード作業は定形で引っかかる箇所もありますが、どちらかというと固有の事情を解決することが多そうなので、どれだけ全体を把握できるかが勝負になると思います。\nElixir ( Phoenix ) + Vue ( Nuxt ) + AWS EKS によるアプリケーション開発\nElixir 全く書いたことなかったのに誘っていただいて貴重な経験ができました。今年はほぼこの案件を中心に動いていました。実稼働している k8s を触れたのも良い経験になりました。\nElixir はパターンマッチが強力なため、今までとはちょっと考え方を変えて書かないといけないところもあり、頭の体操的な面白さがありました。一方で Erlang/OTP 側がわからないと詰まるところもたまにあり、そのあたりの調査力はまだまだ不足していると感じました。あとドキュメントが少ないので大体ソースコードを直接追うことが多いのも大変かなと思います。利用者がもっと増えてほしいところです。\nアプリケーション側以外で大きくやったこととしては、以下のようなものがあります。\n既存インフラの Terraform 化（Terraform Cloud）\nExUnit でのテスト整備\nLamnda@Edge での OIDC 認証\nHeadless CMS の採用\n特に Terraform 化では、既存のインフラとの整合性を保ちつつ IaC しやすい構造を作るというところで多少矛盾が生じるところもあり、落とし所を見つけるのが大変でした。「ここはインポートしたけど新しく追加しないで！」というような感じのコメントを残したりすることでなるべく今後も秩序を維持できるように残しておきました。\n前職でアーキテクチャ設計やCI/CD設計などを全て自分がやるしかなかった経験が生かされ、ある程度構成を見ただけで実用的なTerraform分割の道筋がすぐ見えるようになったと思います。またCI/CDワークフローも整備し、誰でも安全にデプロイできるようにしておきました。\nその他プライベートでやったようなこと\nECSのタスクスケジューラをどうにかしたかった\nAWS ECSのバッチ処理をもう少し使いやすくできないかなーと試行錯誤し、Goでシンプルなスケジューラーでも書こうと思ったのですが、すぐにやる気が消えてしまったのでやめました。ECSの異常終了の検知が思ったより簡単だったのでそれでいいかなという感じもします。（ AWS ECSのタスクが異常終了したらログURL付きでSlackに通知する - nazolabo ）\n現在は MWAA（ Amazon Managed Workflows for Apache Airflow (MWAA) のご紹介 | Amazon Web Services ブログ ）も存在し、Airflow側でもawslogsから実行結果を取得する機能が入っていますので（Airflowのタスク実行環境を分離する｜Dentsu Digital Tech Blog｜note）、ECSのタスクスケジューリングでは機能不足な場合でも困ることはないのではないかと思います。\nVue 3.0 （というか composition API）\n使うかどうかわからないのですが、Vue/Nuxtの最新を追うためにいくつかコードを書いていました。 https://github.com/nazo/binsen/pull/7\n現在のVue/NuxtはReact/Nextの後追いになっている感じが強く、もともとNuxtのほうが実用性としては先行していたはずだったのにというところから、もっとReactとは違う良さを出していってほしいなという感じがします。とはいえ現時点でのフロントエンドはNextかNuxt以外は選択肢にはないと思います。\nWebAssembly\nnazo.hatenablog.com\n感想と今後\n週2で開発業務は翌週に記憶が切れていることが多く、単純にもう1日やったほうがいいなと思うこと多かったので、事業ドメインから外れていてもなかなか厳しいと思いました。よほどピンポイントに専門的な内容を行う場合（技術顧問的な？）でない限り、週3はあったほうがいいのではないかと思います。\n声をかけていただいた会社さんの中には良いポジションを提示してくれたところもあったのですが、週5・出勤あり・正社員でと言われるとお断りするしかないため、申し訳なく思うところもありました。とはいえ今の働き方が現時点では一番良いと思っているので、当面このままで続けていこうと思います。（将来的には変えるとは思います）\nこちらから積極的に声をかけていないということもあり、残念ながら現在仕事が途切れてしまっている状態なので、現在積極的に仕事を募集しております。気軽にご連絡をお待ちしております。詳しくは ポートフォリオ · GitHub をご覧下さい。\nそれでは来年も皆様宜しくお願い致します。","id":"hatenablog://entry/26006613654462210","isoDate":"2020-12-23T03:00:00.000Z"},{"title":"rust-nesをwasm化した","link":"https://nazo.hatenablog.com/entry/rust-nes-wasm","pubDate":"2020-12-22T06:40:53.000Z","author":"nazone","content":"\u003cp\u003e\u003cblockquote data-conversation=\"none\" class=\"twitter-tweet\" data-lang=\"ja\"\u003e\u003cp lang=\"und\" dir=\"ltr\"\u003e\u003ca href=\"https://t.co/E2VxlwpIHi\"\u003ehttps://t.co/E2VxlwpIHi\u003c/a\u003e \u003ca href=\"https://t.co/s4zLgpjhaX\"\u003epic.twitter.com/s4zLgpjhaX\u003c/a\u003e\u003c/p\u003e\u0026mdash; nazo (@nazo) \u003ca href=\"https://twitter.com/nazo/status/1340250195045445632?ref_src=twsrc%5Etfw\"\u003e2020年12月19日\u003c/a\u003e\u003c/blockquote\u003e \u003cscript async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"\u003e\u003c/script\u003e \u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fgithub.com%2Fnazo%2Frust-nes-wasm\" title=\"nazo/rust-nes-wasm\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://github.com/nazo/rust-nes-wasm\"\u003egithub.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e相変わらずOAM描画もキー入力も実装されていないのに\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/NES\"\u003eNES\u003c/a\u003e\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%A8%A5%DF%A5%E5%A5%EC%A1%BC%A5%BF%A1%BC\"\u003eエミュレーター\u003c/a\u003eってレベルじゃないだろという感じですが、ついでに元のrust-\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/nes\"\u003enes\u003c/a\u003eよりいくつか修正してwasmで動くようにしました。ちなみに元のバージョンは\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/SDL\"\u003eSDL\u003c/a\u003eです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://github.com/rustwasm/wasm-pack\"\u003eGitHub - rustwasm/wasm-pack: \u0026#x1F4E6;\u0026#x2728; your favorite rust -\u0026gt; wasm workflow tool!\u003c/a\u003e を使うと、手軽にRustでWebアプリケーションを書くことができます。コアになるライブラリは\n\u003ca href=\"https://github.com/rustwasm/wasm-bindgen\"\u003eGitHub - rustwasm/wasm-bindgen: Facilitating high-level interactions between Wasm modules and JavaScript\u003c/a\u003e なのですが、wasm-packはこれにWebpackなどを追加し、ホットリロード的なものとかを最初から提供してくれるものです。\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://rustwasm.github.io/docs/wasm-bindgen/examples/index.html\"\u003eExamples - The `wasm-bindgen` Guide\u003c/a\u003e が充実しており、今回必要だった\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/canvas\"\u003ecanvas\u003c/a\u003eやfetch、requestAnimationFrameなどはもちろん、\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/WebGL\"\u003eWebGL\u003c/a\u003eやWebRTCのサンプルもあり、すぐに試すことが可能です。Rustが書ける方であればすぐに使えると思います。\u003c/p\u003e\n\n\u003cp\u003eWebAssemblyの現実的な用途としてはWeb的なものよりバイナリ操作的なものが中心になるのではないかと思うのですが、突然使うことになるかもしれないので今のうちに触っておいて損はしないのかなと思っています。\u003c/p\u003e\n\n\u003cp\u003e久々に触ってて面白かったので、もう少し機能を実装したいところです。\u003c/p\u003e\n","contentSnippet":"https://t.co/E2VxlwpIHi pic.twitter.com/s4zLgpjhaX\n— nazo (@nazo) 2020年12月19日\n  \ngithub.com\n相変わらずOAM描画もキー入力も実装されていないのにNESエミュレーターってレベルじゃないだろという感じですが、ついでに元のrust-nesよりいくつか修正してwasmで動くようにしました。ちなみに元のバージョンはSDLです。\nGitHub - rustwasm/wasm-pack: 📦✨ your favorite rust -\u003e wasm workflow tool! を使うと、手軽にRustでWebアプリケーションを書くことができます。コアになるライブラリは\nGitHub - rustwasm/wasm-bindgen: Facilitating high-level interactions between Wasm modules and JavaScript なのですが、wasm-packはこれにWebpackなどを追加し、ホットリロード的なものとかを最初から提供してくれるものです。\nExamples - The `wasm-bindgen` Guide が充実しており、今回必要だったcanvasやfetch、requestAnimationFrameなどはもちろん、WebGLやWebRTCのサンプルもあり、すぐに試すことが可能です。Rustが書ける方であればすぐに使えると思います。\nWebAssemblyの現実的な用途としてはWeb的なものよりバイナリ操作的なものが中心になるのではないかと思うのですが、突然使うことになるかもしれないので今のうちに触っておいて損はしないのかなと思っています。\n久々に触ってて面白かったので、もう少し機能を実装したいところです。","id":"hatenablog://entry/26006613668551571","isoDate":"2020-12-22T06:40:53.000Z"},{"title":"nuxt/http で axios-module の credentials: true を再現する","link":"https://nazo.hatenablog.com/entry/nuxt-http-credentials","pubDate":"2020-10-12T03:05:00.000Z","author":"nazone","content":"\u003cp\u003e\u003ca href=\"https://github.com/nuxt/http\"\u003ehttps://github.com/nuxt/http\u003c/a\u003e は実質 \u003ca href=\"https://github.com/nuxt-community/axios-module\"\u003ehttps://github.com/nuxt-community/axios-module\u003c/a\u003e の後継に当たるもので、fetch \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\"\u003eAPI\u003c/a\u003eをベースにした \u003ca href=\"https://github.com/sindresorhus/ky\"\u003ehttps://github.com/sindresorhus/ky\u003c/a\u003e を利用しています。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fqiita.com%2Fil-m-yamagishi%2Fitems%2Fa823c1afbdf253e84a34\" title=\"nuxt.js は axios を捨てて ky になる様子 - Qiita\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://qiita.com/il-m-yamagishi/items/a823c1afbdf253e84a34\"\u003eqiita.com\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ca href=\"https://http.nuxtjs.org/migration\"\u003eMigration Guides - Http Module\u003c/a\u003e を見てわかる通り、axios-module と比較しても名前が変わっただけのような作りになっており、置換だけでほぼ完全に移行することができますが、nuxt/http では \u003ccode\u003ecredentials: true\u003c/code\u003e オプションが削除されています。今回はこれをどうしたらいいのかという話になります。\u003c/p\u003e\n\n\u003ch1\u003eそもそも axios-module の \u003ccode\u003ecredentials: true\u003c/code\u003e とは？\u003c/h1\u003e\n\n\u003cp\u003eaxios-module の \u003ccode\u003ecredentials: true\u003c/code\u003e は、 \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/XMLHttpRequest\"\u003eXMLHttpRequest\u003c/a\u003e に対し \u003ccode\u003ewithCredentials = true\u003c/code\u003e をデフォルトで設定するためのオプションです。クロス\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003eで\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/Cookie\"\u003eCookie\u003c/a\u003e等の資格情報をXHR経由で渡す時に設定するものです。\u003c/p\u003e\n\n\u003cp\u003e\u003ciframe src=\"https://hatenablog-parts.com/embed?url=https%3A%2F%2Fyamory.io%2Fblog%2Fabout-cors%2F\" title=\"CORS \u0026amp; Same Origin Policy 入門 | yamory Blog\" class=\"embed-card embed-webcard\" scrolling=\"no\" frameborder=\"0\" style=\"display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;\"\u003e\u003c/iframe\u003e\u003ccite class=\"hatena-citation\"\u003e\u003ca href=\"https://yamory.io/blog/about-cors/\"\u003eyamory.io\u003c/a\u003e\u003c/cite\u003e\u003c/p\u003e\n\n\u003cp\u003e\u003ccode\u003ewithCredentials\u003c/code\u003e オプションは XHR 固有のもののため、fetch \u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/API\"\u003eAPI\u003c/a\u003e には存在しません。代わりに \u003ccode\u003ecredentials = 'omit' | 'same-origin' | 'include'\u003c/code\u003e というオプションが存在します。\u003c/p\u003e\n\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eomit\u003c/code\u003e : 同一\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003e上でも資格情報が送られない\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003esame-origin\u003c/code\u003e : 同一\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003e上でのみ資格情報が送られる\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003einclude\u003c/code\u003e : 全ての\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003eで資格情報が送られる\u003c/li\u003e\n\u003c/ul\u003e\n\n\n\u003cp\u003eXHR での \u003ccode\u003ewithCredentials = false\u003c/code\u003e が 'same-origin' で、 \u003ccode\u003ewithCredentials = true\u003c/code\u003e が 'include' に該当します。（ただし polyfill を使うと \u003ccode\u003eomit\u003c/code\u003e に該当する XHR のオプションが存在しないために同一\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%C9%A5%E1%A5%A4%A5%F3\"\u003eドメイン\u003c/a\u003e上では資格情報の送信が行われます）\nなおサーバー側の \u003ccode\u003eAccess-Control-Allow-Credentials\u003c/code\u003e 等は状況に応じて別途必要です。\u003c/p\u003e\n\n\u003ch1\u003enuxt/http で再現する\u003c/h1\u003e\n\n\u003cp\u003e該当のオプションが存在しない nuxt/http で再現するには、デフォルト値を無理やり書き換える必要があります。\u003ca class=\"keyword\" href=\"http://d.hatena.ne.jp/keyword/%A5%D7%A5%E9%A5%B0%A5%A4%A5%F3\"\u003eプラグイン\u003c/a\u003eで対応します。参考：\u003ca href=\"https://github.com/nuxt/http/issues/92\"\u003eGlobally set options.Credentials \u0026middot; Issue #92 \u0026middot; nuxt/http \u0026middot; GitHub\u003c/a\u003e\u003c/p\u003e\n\n\u003cpre class=\"code lang-javascript\" data-lang=\"javascript\" data-unlink\u003e\u003cspan class=\"synStatement\"\u003eexport\u003c/span\u003e \u003cspan class=\"synStatement\"\u003edefault\u003c/span\u003e ( \u003cspan class=\"synIdentifier\"\u003e{\u003c/span\u003e $http \u003cspan class=\"synIdentifier\"\u003e}\u003c/span\u003e ) =\u0026gt; \u003cspan class=\"synIdentifier\"\u003e{\u003c/span\u003e\n    $http._defaults.credentials = \u003cspan class=\"synConstant\"\u003e'include'\u003c/span\u003e; \n\u003cspan class=\"synIdentifier\"\u003e}\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003cp\u003eTypeScriptではプロパティにアクセスができないので、型を破壊して強引にプロパティを変更します。\u003c/p\u003e\n\n\u003cpre class=\"code lang-typescript\" data-lang=\"typescript\" data-unlink\u003e\u003cspan class=\"synStatement\"\u003eimport\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e{\u003c/span\u003e defineNuxtPlugin \u003cspan class=\"synIdentifier\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003efrom\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e'@nuxtjs/composition-api'\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003cspan class=\"synStatement\"\u003eimport\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e{\u003c/span\u003e Context \u003cspan class=\"synIdentifier\"\u003e}\u003c/span\u003e \u003cspan class=\"synStatement\"\u003efrom\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e'@nuxt/types/app'\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"synStatement\"\u003eexport\u003c/span\u003e \u003cspan class=\"synStatement\"\u003edefault\u003c/span\u003e defineNuxtPlugin\u003cspan class=\"synStatement\"\u003e((\u003c/span\u003e\u003cspan class=\"synIdentifier\"\u003e{\u003c/span\u003e $http \u003cspan class=\"synIdentifier\"\u003e}\u003c/span\u003e: Context\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e \u003cspan class=\"synStatement\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"synIdentifier\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"synStatement\"\u003e(\u003c/span\u003e$http \u003cspan class=\"synStatement\"\u003eas\u003c/span\u003e \u003cspan class=\"synType\"\u003eany\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e)\u003c/span\u003e._defaults.credentials \u003cspan class=\"synStatement\"\u003e=\u003c/span\u003e \u003cspan class=\"synConstant\"\u003e'include'\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e;\u003c/span\u003e\n\u003cspan class=\"synIdentifier\"\u003e}\u003c/span\u003e\u003cspan class=\"synStatement\"\u003e);\u003c/span\u003e\n\u003c/pre\u003e\n\n\n\u003ch1\u003eまとめ\u003c/h1\u003e\n\n\u003cp\u003eセキュリティ上の懸念点があるためにこのような対応が行われていると思いますので、強引に変えるのは良くないのではないかと思います。\u003c/p\u003e\n\n\u003cp\u003enuxt/http では \u003ccode\u003esetToken()\u003c/code\u003e というメソッドが用意されており、 \u003ccode\u003eAuthorization\u003c/code\u003e ヘッダをこちらでグローバルに指定することが可能です。こちらで資格情報を管理するのが良いのではないかと思いますが、axios-module と互換性があると言うのであれば credentials 指定があっても良かったのではないかと思います。\u003c/p\u003e\n","contentSnippet":"https://github.com/nuxt/http は実質 https://github.com/nuxt-community/axios-module の後継に当たるもので、fetch APIをベースにした https://github.com/sindresorhus/ky を利用しています。\nqiita.com\nMigration Guides - Http Module を見てわかる通り、axios-module と比較しても名前が変わっただけのような作りになっており、置換だけでほぼ完全に移行することができますが、nuxt/http では credentials: true オプションが削除されています。今回はこれをどうしたらいいのかという話になります。\nそもそも axios-module の credentials: true とは？\naxios-module の credentials: true は、 XMLHttpRequest に対し withCredentials = true をデフォルトで設定するためのオプションです。クロスドメインでCookie等の資格情報をXHR経由で渡す時に設定するものです。\nyamory.io\nwithCredentials オプションは XHR 固有のもののため、fetch API には存在しません。代わりに credentials = 'omit' | 'same-origin' | 'include' というオプションが存在します。\nomit : 同一ドメイン上でも資格情報が送られない\nsame-origin : 同一ドメイン上でのみ資格情報が送られる\ninclude : 全てのドメインで資格情報が送られる\nXHR での withCredentials = false が 'same-origin' で、 withCredentials = true が 'include' に該当します。（ただし polyfill を使うと omit に該当する XHR のオプションが存在しないために同一ドメイン上では資格情報の送信が行われます）\nなおサーバー側の Access-Control-Allow-Credentials 等は状況に応じて別途必要です。\nnuxt/http で再現する\n該当のオプションが存在しない nuxt/http で再現するには、デフォルト値を無理やり書き換える必要があります。プラグインで対応します。参考：Globally set options.Credentials · Issue #92 · nuxt/http · GitHub\nexport default ( { $http } ) =\u003e {\n    $http._defaults.credentials = 'include'; \n}\n\n\n\nTypeScriptではプロパティにアクセスができないので、型を破壊して強引にプロパティを変更します。\nimport { defineNuxtPlugin } from '@nuxtjs/composition-api';\nimport { Context } from '@nuxt/types/app';\n\nexport default defineNuxtPlugin(({ $http }: Context) =\u003e {\n  ($http as any)._defaults.credentials = 'include';\n});\n\n\n\nまとめ\nセキュリティ上の懸念点があるためにこのような対応が行われていると思いますので、強引に変えるのは良くないのではないかと思います。\nnuxt/http では setToken() というメソッドが用意されており、 Authorization ヘッダをこちらでグローバルに指定することが可能です。こちらで資格情報を管理するのが良いのではないかと思いますが、axios-module と互換性があると言うのであれば credentials 指定があっても良かったのではないかと思います。","id":"hatenablog://entry/26006613639334572","isoDate":"2020-10-12T03:05:00.000Z"},{"title":"Nuxt.jsの型定義ファイル","link":"https://gist.github.com/nazo/400638c53982b485b4865e3b2361ab45","pubDate":"2020-08-31T08:27:55.000Z","author":"nazo","content":"  \u003ca href=\"https://gist.github.com/nazo/400638c53982b485b4865e3b2361ab45#file-gistfile1-txt\"\u003egistfile1.txt\u003c/a\u003e\n  \u003cdiv class=\"js-gist-file-update-container js-task-list-container file-box\"\u003e\n  \u003cdiv id=\"file-gistfile1-txt\" class=\"file my-2\"\u003e\n    \n  \u003cdiv itemprop=\"text\" class=\"Box-body p-0 blob-wrapper data type-text  \"\u003e\n\n      \n\u003cdiv class=\"js-check-bidi js-blob-code-container blob-code-content\"\u003e\n\n  \u003ctemplate class=\"js-file-alert-template\"\u003e\n  \u003cdiv data-view-component=\"true\" class=\"flash flash-warn flash-full d-flex flex-items-center\"\u003e\n  \u003csvg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"\u003e\n    \u003cpath fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n  \n    \u003cspan\u003e\n      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.\n      \u003ca href=\"https://github.co/hiddenchars\" target=\"_blank\"\u003eLearn more about bidirectional Unicode characters\u003c/a\u003e\n    \u003c/span\u003e\n\n\n  \u003cdiv data-view-component=\"true\" class=\"flash-action\"\u003e        \u003ca href=\"{{ revealButtonHref }}\" data-view-component=\"true\" class=\"btn-sm btn\"\u003e  Show hidden characters\n\u003c/a\u003e\n\u003c/div\u003e\n\u003c/div\u003e\u003c/template\u003e\n\u003ctemplate class=\"js-line-alert-template\"\u003e\n  \u003cspan aria-label=\"This line has hidden Unicode characters\" data-view-component=\"true\" class=\"line-alert tooltipped tooltipped-e\"\u003e\n    \u003csvg aria-hidden=\"true\" height=\"16\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" data-view-component=\"true\" class=\"octicon octicon-alert\"\u003e\n    \u003cpath fill-rule=\"evenodd\" d=\"M8.22 1.754a.25.25 0 00-.44 0L1.698 13.132a.25.25 0 00.22.368h12.164a.25.25 0 00.22-.368L8.22 1.754zm-1.763-.707c.659-1.234 2.427-1.234 3.086 0l6.082 11.378A1.75 1.75 0 0114.082 15H1.918a1.75 1.75 0 01-1.543-2.575L6.457 1.047zM9 11a1 1 0 11-2 0 1 1 0 012 0zm-.25-5.25a.75.75 0 00-1.5 0v2.5a.75.75 0 001.5 0v-2.5z\"\u003e\u003c/path\u003e\n\u003c/svg\u003e\n\u003c/span\u003e\u003c/template\u003e\n\n  \u003ctable class=\"highlight tab-size js-file-line-container js-code-nav-container js-tagsearch-file\" data-tab-size=\"8\" data-paste-markdown-skip data-tagsearch-lang=\"Text\" data-tagsearch-path=\"gistfile1.txt\"\u003e\n        \u003ctr\u003e\n          \u003ctd id=\"file-gistfile1-txt-L1\" class=\"blob-num js-line-number js-code-nav-line-number js-blob-rnum\" data-line-number=\"1\"\u003e\u003c/td\u003e\n          \u003ctd id=\"file-gistfile1-txt-LC1\" class=\"blob-code blob-code-inner js-file-line\"\u003ehttps://github.com/nuxt/nuxt.js/tree/dev/packages/types/app\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n          \u003ctd id=\"file-gistfile1-txt-L2\" class=\"blob-num js-line-number js-code-nav-line-number js-blob-rnum\" data-line-number=\"2\"\u003e\u003c/td\u003e\n          \u003ctd id=\"file-gistfile1-txt-LC2\" class=\"blob-code blob-code-inner js-file-line\"\u003e\n\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n          \u003ctd id=\"file-gistfile1-txt-L3\" class=\"blob-num js-line-number js-code-nav-line-number js-blob-rnum\" data-line-number=\"3\"\u003e\u003c/td\u003e\n          \u003ctd id=\"file-gistfile1-txt-LC3\" class=\"blob-code blob-code-inner js-file-line\"\u003eここにある\u003c/td\u003e\n        \u003c/tr\u003e\n  \u003c/table\u003e\n\u003c/div\u003e\n\n\n  \u003c/div\u003e\n\n  \u003c/div\u003e\n\u003c/div\u003e\n\n","contentSnippet":"gistfile1.txt\n  \n\n\n  \n    \n      This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.\n      Learn more about bidirectional Unicode characters\n    \n\n\n  \n          Show hidden characters\n\n\n\n\n  \n    \n    \n\n\n\n\n  \n\n          https://github.com/nuxt/nuxt.js/tree/dev/packages/types/app\n        \n\n          \n\n        \n\n          ここにある","id":"tag:gist.github.com,2008:Gist/nazo/400638c53982b485b4865e3b2361ab45","isoDate":"2020-08-31T08:27:55.000Z"},{"title":"WSL2 小ネタ","link":"https://gist.github.com/nazo/d2f765da5942b8d71797b188f20c4bb0","pubDate":"2020-08-07T00:23:45.000Z","author":"nazo","content":"  \u003ca href=\"https://gist.github.com/nazo/d2f765da5942b8d71797b188f20c4bb0#file-wsl2-md\"\u003ewsl2.md\u003c/a\u003e\n  \u003cdiv class=\"js-gist-file-update-container js-task-list-container file-box\"\u003e\n  \u003cdiv id=\"file-wsl2-md\" class=\"file my-2\"\u003e\n      \u003cdiv id=\"file-wsl2-md-readme\" class=\"Box-body readme blob js-code-block-container p-5 p-xl-6 \"\u003e\n    \u003carticle class=\"markdown-body entry-content container-lg\" itemprop=\"text\"\u003e\u003ch1 dir=\"auto\"\u003e\u003ca id=\"user-content-wsl2でシェル補完が遅い時\" class=\"anchor\" aria-hidden=\"true\" href=\"#wsl2でシェル補完が遅い時\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eWSL2でシェル補完が遅い時\u003c/h1\u003e\n\u003cp dir=\"auto\"\u003e\u003ca class=\"issue-link js-issue-link\" data-error-text=\"Failed to load title\" data-id=\"460623084\" data-permission-text=\"Title is private\" data-url=\"https://github.com/microsoft/WSL/issues/4234\" data-hovercard-type=\"issue\" data-hovercard-url=\"/microsoft/WSL/issues/4234/hovercard\" href=\"https://github.com/microsoft/WSL/issues/4234\"\u003emicrosoft/WSL#4234\u003c/a\u003e\u003c/p\u003e\n\u003cp dir=\"auto\"\u003e/etc/wsl.conf に以下を記述する\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e[interop]\nappendWindowsPath = false\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch1 dir=\"auto\"\u003e\u003ca id=\"user-content-windows起動時にwsl2を起動しないようにする\" class=\"anchor\" aria-hidden=\"true\" href=\"#windows起動時にwsl2を起動しないようにする\"\u003e\u003csvg class=\"octicon octicon-link\" viewBox=\"0 0 16 16\" version=\"1.1\" width=\"16\" height=\"16\" aria-hidden=\"true\"\u003e\u003cpath fill-rule=\"evenodd\" d=\"M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z\"\u003e\u003c/path\u003e\u003c/svg\u003e\u003c/a\u003eWindows起動時にWSL2を起動しないようにする\u003c/h1\u003e\n\u003cp dir=\"auto\"\u003eできなさそうなのでスタートアップに適当なバッチファイルを作って \u003ccode\u003ewsl --shutdown\u003c/code\u003e と書いておく\u003c/p\u003e\n\u003cp dir=\"auto\"\u003eちなみにシャットダウンした後の起動はWindows Terminalを起動するなりしてWSL2にアクセスしようとすると自動的に起動する\u003c/p\u003e\n\u003c/article\u003e\n  \u003c/div\u003e\n\n  \u003c/div\u003e\n\u003c/div\u003e\n\n","contentSnippet":"wsl2.md\n  \n\nWSL2でシェル補完が遅い時\nmicrosoft/WSL#4234\n/etc/wsl.conf に以下を記述する\n[interop]\nappendWindowsPath = false\n\n\nWindows起動時にWSL2を起動しないようにする\nできなさそうなのでスタートアップに適当なバッチファイルを作って wsl --shutdown と書いておく\nちなみにシャットダウンした後の起動はWindows Terminalを起動するなりしてWSL2にアクセスしようとすると自動的に起動する","id":"tag:gist.github.com,2008:Gist/nazo/d2f765da5942b8d71797b188f20c4bb0","isoDate":"2020-08-07T00:23:45.000Z"}]},"__N_SSG":true},"page":"/","query":{},"buildId":"R8mBktx4UQO9HsIBGaZuR","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>